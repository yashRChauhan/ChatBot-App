<!DOCTYPE html>
<html>

<head>
    <title>Chatbot</title>
</head>

<body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

    <script src="https://unpkg.com/supersimpledev/Chatbot.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">

        function ChatInput( {chatMessages, setChatMessages}) {
            const [inputText, setInputText] = React.useState('')

            function sendMessage() {
                const newMessage = [
                    ...chatMessages, 
                    {
                        message: inputText,
                        sender: 'user',
                        id: crypto.randomUUID()
                    }
                ]

                setChatMessages(newMessage)

                const response = Chatbot.getResponse(inputText)

                setChatMessages([
                    ...newMessage, 
                    {
                        message: response,
                        sender: 'robot',
                        id: crypto.randomUUID()
                    }
                ])

                setInputText('')
            }

            return (
                <>
                    <input
                        type="text"
                        placeholder="Send a message to the Chatbot!"
                        size="30"
                        onChange={e => setInputText(e.target.value)}
                        value={inputText}
                    />
                    <button onClick={sendMessage}>Send</button>
                </>
            )
        }

        function ChatMessage({ message, sender }) {
            // const {message, sender} = props

            return (
                <div>
                    {sender === 'robot' && <img src="robot.png" alt="" width="50" />}
                    {message}
                    {sender === 'user' && <img src="user.png" alt="" width="50" />}
                </div>
            )
        }

        function ChatMessages({ chatMessages, setChatMessages}) {

            return (
                <>
                    {chatMessages.map((msg) => {
                        return (
                            <ChatMessage
                                message={msg.message}
                                sender={msg.sender}
                                key={msg.id}
                            />
                        )
                    })}
                </>
            )
        }



        function App() {

            const [chatMessages, setChatMessages] = React.useState([])

            return (
                <div>
                    <ChatInput
                        chatMessages={chatMessages}
                        setChatMessages={setChatMessages}
                    />
                    <ChatMessages
                        chatMessages={chatMessages}
                        setChatMessages={setChatMessages}
                    />
                </div>
            )
        }

        const container = document.querySelector('.js-container');
        ReactDOM.createRoot(container).render(<App />);
    </script>
</body>

</html>